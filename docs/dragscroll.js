/*!
 * 
 *     Copyright (c) 2020 XuanVinh
 *     name: dragscroll-ts
 *     license: MIT
 *     author: vinhmai <vinhmai079@gmail.com>
 *     repository: git+https://github.com/xaunvih/dragscroll-ts
 *     version: 1.0.3
 */
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("DragScroll",[],n):"object"==typeof exports?exports.DragScroll=n():t.DragScroll=n()}(window,(function(){return function(t){var n={};function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(i,o,function(n){return t[n]}.bind(null,o));return i},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=1)}([function(t,n){window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return window.setTimeout(t,16)}},function(t,n,e){"use strict";e.r(n);e(0);var i=function(){function t(){var t;this.emitter={all:t=t||new Map,on:function(n,e){var i=t.get(n);i&&i.push(e)||t.set(n,[e])},off:function(n,e){var i=t.get(n);i&&i.splice(i.indexOf(e)>>>0,1)},emit:function(n,e){(t.get(n)||[]).slice().map((function(t){t(e)})),(t.get("*")||[]).slice().map((function(t){t(n,e)}))}}}return t.prototype.on=function(t,n){this.emitter.on(t,n)},t.prototype.off=function(t,n){this.emitter.off(t,n)},t.prototype.trigger=function(t,n){this.emitter.emit(t,n)},t}();var o,r=(o=function(t,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),s=function(){return(s=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},a=function(t){function n(n){var e=t.call(this)||this;e.options=Object.assign({axis:"x",allowInputFocus:!0,allowSelectText:!0},n);var i={x:0,y:0};return e.state={startPosition:s({},i),previousPosition:s({},i),position:s({},i),dragPosition:s({},i),velocity:s({},i),dragOffset:s({},i),targetPosition:s({},i),isRunning:!1,isDragging:!1,isScrollToRunning:!1},e.friction=.95,e.frictionTarget=.08,e.bounceForce=.1,e.$container=e.options.$container,e.$content=e.options.$content,e.onDragStart=e.onDragStart.bind(e),e.onDraging=e.onDraging.bind(e),e.onDragEnd=e.onDragEnd.bind(e),e.onClick=e.onClick.bind(e),e.onResize=e.onResize.bind(e),e.animate=e.animate.bind(e),e.bindEvents(),e.updateMeta(),e}return r(n,t),n.prototype.bindEvents=function(){this.$content.addEventListener("click",this.onClick),this.$content.addEventListener("mousedown",this.onDragStart),window.addEventListener("mousemove",this.onDraging),window.addEventListener("mouseup",this.onDragEnd),this.$content.addEventListener("touchstart",this.onDragStart,{passive:!1}),window.addEventListener("touchmove",this.onDraging,{passive:!1}),window.addEventListener("touchend",this.onDragEnd),window.addEventListener("resize",this.onResize),this.onChildrenChange()},n.prototype.updateMeta=function(){this.metaData={containerWidth:this.$container.clientWidth,containerHeight:this.$container.clientHeight,contentWidth:this.$content.clientWidth,contentHeight:this.$content.clientHeight}},n.prototype.onResize=function(t){this.updateMeta(),this.trigger("resize",t)},n.prototype.onChildrenChange=function(){var t=this;this.observer=new MutationObserver((function(n){for(var e=0,i=n;e<i.length;e++){var o=i[e];"childList"===o.type&&(t.updateMeta(),t.trigger("childrenChange",o))}})),this.observer.observe(this.$container,{attributes:!1,childList:!0,subtree:!0})},n.prototype.destroy=function(){this.$content.removeEventListener("click",this.onClick),this.$content.removeEventListener("mousedown",this.onDragStart),window.removeEventListener("mousemove",this.onDraging),window.removeEventListener("mouseup",this.onDragEnd),this.$content.removeEventListener("touchstart",this.onDragStart),window.removeEventListener("touchmove",this.onDraging),window.removeEventListener("touchend",this.onDragEnd),window.removeEventListener("resize",this.onResize),this.observer.disconnect()},n.prototype.update=function(){var t=this.state,n=t.isDragging,e=t.isScrollToRunning;n&&this.applyDragForce(),n||this.applyAllBoundForce(),e&&this.applyTargetForce();var i=this.state,o=i.position,r=i.velocity,s=this.options.axis;r.x*=this.friction,r.y*=this.friction,"y"!==s&&(o.x+=r.x),"x"!==s&&(o.y+=r.y)},n.prototype.applyForce=function(t){var n=this.state.velocity;n.x+=t.x,n.y+=t.y},n.prototype.applyTargetForce=function(){var t=this.state,n=t.position,e=t.velocity,i=t.targetPosition;this.applyForce({x:(i.x-n.x)*this.frictionTarget-e.x,y:(i.y-n.y)*this.frictionTarget-e.y})},n.prototype.applyDragForce=function(){var t=this.state,n=t.position,e=t.dragPosition,i=t.velocity,o={x:e.x-n.x-i.x,y:e.y-n.y-i.y};this.applyForce(o)},n.prototype.applyAllBoundForce=function(){var t=this,n=this.metaData,e=n.containerWidth,i=n.containerHeight;[{bound:e-n.contentWidth,axis:"x"},{bound:0,isForward:!0,axis:"x"},{bound:i-n.contentHeight,axis:"y"},{bound:0,isForward:!0,axis:"y"}].forEach((function(n){return t.applyBoundForce(n)}))},n.prototype.applyBoundForce=function(t){var n,e=t.bound,i=t.isForward,o=void 0!==i&&i,r=t.axis,s=this.state,a=s.velocity,c=s.position[r],u=a[r];if(!(o?c<e:c>e)){var p=e-c,h=p*this.bounceForce,d=c+(u+h)*this.friction/(1-this.friction);(o?d>e:d<e)||(h=p*this.bounceForce-u),this.applyForce(((n={x:0,y:0})[r]=h,n))}},n.prototype.onClick=function(t){var n=this.state.dragOffset;(Math.abs(n.x)>5||Math.abs(n.y)>5)&&(t.preventDefault(),t.stopPropagation())},n.prototype.onDragStart=function(t){var n=t.target;if(!(this.options.allowInputFocus&&["input","textarea","button","select","label"].indexOf(n.nodeName.toLowerCase())>-1)){var e=Boolean(t.targetTouches),i=e?t.targetTouches[0]:t,o=i.clientX,r=i.clientY;this.options.allowSelectText&&function(t,n,e){for(var i=t.childNodes,o=document.createRange(),r=0;r<i.length;r++){var s=i[r];if(3===s.nodeType){o.selectNodeContents(s);var a=o.getBoundingClientRect();if(n>=a.left&&e>=a.top&&n<=a.right&&e<=a.bottom)return!0}}return!1}(n,o,r)||(e||(t.preventDefault(),t.stopPropagation()),this.trigger("dragstart",t),this.state.isDragging=!0,this.state.startPosition={x:o,y:r},this.state.previousPosition=s({},this.state.position),this.setDragPosition(this.state.startPosition),this.startAnimation())}},n.prototype.onDraging=function(t){if(this.state.isDragging){var n=Boolean(t.targetTouches)?t.targetTouches[0]:t,e=n.clientX,i=n.clientY;this.setDragPosition({x:e,y:i}),this.trigger("dragging",t)}},n.prototype.onDragEnd=function(t){this.state.isDragging&&this.trigger("dragend",t),this.state.isDragging=!1},n.prototype.setDragPosition=function(t){var n=t.x,e=t.y,i=this.state,o=i.startPosition,r=i.dragPosition,s=i.previousPosition,a=i.dragOffset;a.x=n-o.x,a.y=e-o.y,r.x=s.x+a.x,r.y=s.y+a.y},n.prototype.setInputCanBeFocused=function(t){void 0===t&&(t=!1),this.options.allowInputFocus=t},n.prototype.setTextCanBeSelected=function(t){void 0===t&&(t=!1),this.options.allowSelectText=t},n.prototype.scrollTo=function(t){var n=s({x:0,y:0},t);this.state.isScrollToRunning=!0,this.state.targetPosition=n,this.startAnimation()},n.prototype.adaptContentPosition=function(){var t=this.state.position;this.$content.style.transform="translate("+t.x+"px,"+t.y+"px)"},n.prototype.isMoving=function(){var t=this.state,n=t.isDragging,e=t.velocity;return n||Math.abs(e.x)>=.01||Math.abs(e.y)>=.01},n.prototype.animate=function(){this.state.isRunning&&(this.update(),this.isMoving()||(this.state.isRunning=!1,this.state.isScrollToRunning=!1),this.adaptContentPosition(),this.rafID=window.requestAnimationFrame(this.animate))},n.prototype.startAnimation=function(){this.state.isRunning=!0,window.cancelAnimationFrame(this.rafID),this.rafID=window.requestAnimationFrame(this.animate)},n}(i);n.default=a}]).default}));